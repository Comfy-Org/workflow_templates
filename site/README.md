# ComfyUI Template Site

Static site for browsing and discovering ComfyUI workflow templates with AI-generated content.

## Quick Start

```bash
# Install dependencies
pnpm install

# Copy environment file and add your OpenAI API key
cp .env.example .env

# Run development server
pnpm run dev
```

## Commands

| Command | Description |
|---------|-------------|
| `pnpm run dev` | Start Astro development server |
| `pnpm run sync` | Sync templates from `../templates/` to content collection |
| `pnpm run sync:tutorials` | Sync tutorials from docs repo |
| `pnpm run generate:ai` | Generate AI descriptions and FAQs |
| `pnpm run generate:ai:test` | Test with first template only |
| `pnpm run generate:previews` | Generate workflow preview images |
| `pnpm run build` | Full build (runs sync, generate:ai, generate:previews, then astro build) |
| `pnpm run preview` | Preview production build locally |

## Skipping AI Generation

To skip AI content generation (useful for quick local builds):

```bash
SKIP_AI_GENERATION=true pnpm run build
```

Or set `SKIP_AI_GENERATION=true` in your `.env` file.

When skipped, templates will use placeholder content for AI-generated fields.

## AI Content Generation

### Content Templates

Four content template types for different user intents:

| Template | Target User | SEO Focus |
|----------|-------------|-----------|
| **tutorial** | Beginners | "How to [task] in ComfyUI" |
| **showcase** | Creators | "[Model] examples" |
| **comparison** | Researchers | "best [task] workflow" |
| **breakthrough** | Early adopters | "[Model] new features" |

### Human Overrides

To manually edit AI-generated content for a specific template:

1. Create a file in `overrides/templates/{template-name}.json`
2. Add only the fields you want to override:
   ```json
   {
     "extendedDescription": "Your custom description here.",
     "humanEdited": true
   }
   ```
3. The sync script will merge overrides with generated content
4. Templates with `humanEdited: true` will not be regenerated by AI

### Override Fields

| Field | Type | Description |
|-------|------|-------------|
| `extendedDescription` | string | Long-form template description |
| `howToUse` | string[] | Step-by-step usage instructions |
| `metaDescription` | string | SEO meta description (150-160 chars) |
| `suggestedUseCases` | string[] | Example use cases |
| `faqItems` | object[] | FAQ questions and answers |
| `humanEdited` | boolean | Set to `true` to prevent AI regeneration |

### Adding Knowledge

Improve AI output by adding documentation:

- `knowledge/models/{model-name}.md` - Model capabilities
- `knowledge/concepts/{concept-name}.md` - Domain concepts
- `knowledge/prompts/{template-type}.md` - Content templates

## Environment Variables

| Variable | Required | Description |
|----------|----------|-------------|
| `OPENAI_API_KEY` | Yes* | OpenAI API key for content generation |
| `SKIP_AI_GENERATION` | No | Set to `true` to skip AI generation |

*Required for production builds; can skip for local development.

## Project Structure

```
site/
├── src/
│   ├── content/
│   │   ├── config.ts           # Content collection schema
│   │   └── templates/          # Generated (git-ignored)
│   ├── pages/
│   │   ├── index.astro         # Homepage
│   │   └── templates/
│   │       ├── index.astro     # Template listing
│   │       └── [slug].astro    # Template detail page
│   ├── layouts/
│   └── components/
├── scripts/
│   ├── sync-templates.ts       # Sync from ../templates/
│   ├── sync-tutorials.ts       # Sync tutorials from docs repo
│   ├── generate-ai.ts          # AI content generation
│   └── generate-previews.ts    # Workflow preview images
├── knowledge/
│   ├── prompts/                # Content template prompts
│   ├── models/                 # Model documentation
│   ├── concepts/               # Domain concepts
│   └── tutorials/              # Synced tutorials (git-ignored)
├── overrides/
│   └── templates/              # Human edits (committed)
├── public/
│   ├── thumbnails/             # Synced from ../templates/
│   └── previews/               # Generated workflow images
└── .content-cache/             # AI generation cache (git-ignored)
```

## Deployment

The site is deployed to Vercel via GitHub Actions. See `.github/workflows/deploy-site.yml`.

### Required Secrets

Configure these in GitHub repository settings:

- `OPENAI_API_KEY` - OpenAI API key
- `VERCEL_TOKEN` - Vercel authentication token
- `VERCEL_ORG_ID` - Vercel organization ID
- `VERCEL_PROJECT_ID` - Vercel project ID

### Manual Deployment

Trigger a deploy from the Actions tab using the "Deploy Template Site" workflow.

## Related Documentation

- [AI Content Generation Strategy](../docs/ai-content-generation-strategy.md)
- [Implementation Roadmap](../docs/ROADMAP.md)
- [Template Site PRD](../docs/template-site-prd.md)
- [Template Site Design](../docs/template-site-design.md)
