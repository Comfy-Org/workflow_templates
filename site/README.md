# ComfyUI Template Site

Static site for browsing and discovering ComfyUI workflow templates.

## Quick Start

```bash
cd site

# Install dependencies
npm install

# Copy environment file and add your OpenAI API key
cp .env.example .env

# Run development server
npm run dev
```

## npm Scripts

| Script | Description |
|--------|-------------|
| `npm run dev` | Start Astro development server |
| `npm run sync` | Sync templates from `../templates/` to content collection |
| `npm run generate:ai` | Generate AI descriptions and FAQs |
| `npm run generate:previews` | Generate workflow preview images |
| `npm run build` | Full build (runs sync, generate:ai, generate:previews, then astro build) |
| `npm run preview` | Preview production build locally |

## Skipping AI Generation

To skip AI content generation (useful for quick local builds):

```bash
SKIP_AI_GENERATION=true npm run build
```

Or set `SKIP_AI_GENERATION=true` in your `.env` file.

When skipped, templates will use placeholder content for AI-generated fields.

## Human Overrides

To manually edit AI-generated content for a specific template:

1. Create a file in `overrides/templates/{template-name}.json`
2. Add only the fields you want to override:
   ```json
   {
     "extendedDescription": "Your custom description here.",
     "humanEdited": true
   }
   ```
3. The sync script will merge overrides with generated content
4. Templates with `humanEdited: true` will not be regenerated by AI

### Override Fields

| Field | Type | Description |
|-------|------|-------------|
| `extendedDescription` | string | Long-form template description |
| `howToUse` | string[] | Step-by-step usage instructions |
| `metaDescription` | string | SEO meta description (150-160 chars) |
| `suggestedUseCases` | string[] | Example use cases |
| `faqItems` | object[] | FAQ questions and answers |
| `humanEdited` | boolean | Set to `true` to prevent AI regeneration |

## Environment Variables

| Variable | Required | Description |
|----------|----------|-------------|
| `OPENAI_API_KEY` | Yes* | OpenAI API key for content generation |
| `SKIP_AI_GENERATION` | No | Set to `true` to skip AI generation |

*Required for production builds; can skip for local development.

## Project Structure

```
site/
├── src/
│   ├── content/
│   │   ├── config.ts           # Content collection schema
│   │   └── templates/          # Generated (git-ignored)
│   ├── pages/
│   │   ├── index.astro         # Homepage
│   │   └── templates/
│   │       ├── index.astro     # Template listing
│   │       └── [slug].astro    # Template detail page
│   ├── layouts/
│   └── components/
├── scripts/
│   ├── sync-templates.ts       # Sync from ../templates/
│   ├── generate-ai.ts          # AI content generation
│   └── generate-previews.ts    # Workflow preview images
├── overrides/
│   └── templates/              # Human edits (committed)
├── public/
│   ├── thumbnails/             # Synced from ../templates/
│   └── previews/               # Generated workflow images
└── .content-cache/             # AI generation cache (git-ignored)
```

## Deployment

The site is deployed to Vercel via GitHub Actions. See `.github/workflows/deploy-site.yml`.

### Required Secrets

Configure these in GitHub repository settings:

- `OPENAI_API_KEY` - OpenAI API key
- `VERCEL_TOKEN` - Vercel authentication token
- `VERCEL_ORG_ID` - Vercel organization ID
- `VERCEL_PROJECT_ID` - Vercel project ID

### Manual Deployment

Trigger a deploy from the Actions tab using the "Deploy Template Site" workflow.

## Learn More

- [Astro Documentation](https://docs.astro.build)
- [ComfyUI](https://github.com/comfyanonymous/ComfyUI)
